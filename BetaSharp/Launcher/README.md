Most of this code was written by AI. You have been warned.